<div class="editor-group">
  <h2>Upload Twibbon ke Galeri</h2>
  <form id="uploadToGalleryForm">
    <input type="file" id="galleryTemplateInput" accept="image/png,image/jpeg" required />
    <input type="text" id="templateTitle" placeholder="Nama Twibbon" />
    <button type="submit" class="btn secondary small">Upload ke Galeri</button>
  </form>
  <p class="helper-text">Template yang diupload akan disimpan di galeri komunitas.</p>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    var form = document.getElementById("uploadToGalleryForm");
    if (!form) return;
    form.addEventListener("submit", function (e) {
      e.preventDefault();
      var fileInput = document.getElementById("galleryTemplateInput");
      var titleInput = document.getElementById("templateTitle");
      if (!fileInput.files || !fileInput.files[0]) {
        alert("Pilih file terlebih dahulu");
        return;
      }
      var formData = new FormData();
      formData.append("file", fileInput.files[0]);
      if (titleInput.value) {
        formData.append("title", titleInput.value);
      }
      fetch("/api/templates", {
        method: "POST",
        body: formData
      })
        .then(function (res) {
          return res.json();
        })
        .then(function (data) {
          if (data && data.id) {
            alert("Template berhasil diupload ke galeri");
          } else {
            alert("Upload selesai, tetapi server tidak mengembalikan data id");
          }
        })
        .catch(function () {
          alert("Gagal upload template ke galeri");
        });
    });
  });
</script>
